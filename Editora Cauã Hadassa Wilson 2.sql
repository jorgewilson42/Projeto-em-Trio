-- MySQL Script generated by MySQL Workbench
-- Fri Oct 18 13:42:13 2024
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering


SET foreign_key_checks = 0;


SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema livraria
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema livraria
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `livraria` DEFAULT CHARACTER SET utf8 ;
USE `livraria` ;

-- -----------------------------------------------------
-- Table `livraria`.`Funcionario`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `livraria`.`Funcionario` (
  `cpf` VARCHAR(45) NOT NULL,
  `dataNasc` DATE NOT NULL,
  `estadoCivil` VARCHAR(45) NOT NULL,
  `telefone` INT NOT NULL,
  `nome` VARCHAR(45) NOT NULL,
  `nomeSocial` VARCHAR(45) NULL,
  `email` VARCHAR(45) NOT NULL,
  `sexo` CHAR(1) NOT NULL,
  PRIMARY KEY (`cpf`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `livraria`.`Endereco`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `livraria`.`Endereco` (
  `bairro` INT NOT NULL,
  `uf` VARCHAR(45) NOT NULL,
  `comp` VARCHAR(45) NULL,
  `cidade` VARCHAR(45) NOT NULL,
  `numero` VARCHAR(45) NOT NULL,
  `cep` VARCHAR(45) NOT NULL,
  `rua` VARCHAR(45) NOT NULL,
  `Funcionario_cpf` VARCHAR(45) NOT NULL,
  INDEX `fk_Endereço_Funcionario_idx` (`Funcionario_cpf` ASC) VISIBLE,
  CONSTRAINT `fk_Endereço_Funcionario`
    FOREIGN KEY (`Funcionario_cpf`)
    REFERENCES `mydb`.`Funcionario` (`cpf`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `livraria`.`Dependentes`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `livraria`.`Dependentes` (
  `cpf` INT NOT NULL,
  `parentesco` VARCHAR(45) NOT NULL,
  `dataNasc` DATE NOT NULL,
  `nome` VARCHAR(45) NOT NULL,
  `Funcionario_cpf` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`cpf`),
  INDEX `fk_Dependentes_Funcionário1_idx` (`Funcionario_cpf` ASC) VISIBLE,
  CONSTRAINT `fk_Dependentes_Funcionário1`
    FOREIGN KEY (`Funcionario_cpf`)
    REFERENCES `mydb`.`Funcionario` (`cpf`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `livraria`.`Ferias`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `livraria`.`Ferias` (
  `idFerias` INT NOT NULL,
  `dataFim` DATE NOT NULL,
  `dataIni` DATE NOT NULL,
  `qtdDias` INT NOT NULL,
  `anoRef` DATE NOT NULL,
  `Funcionario_cpf` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`idFerias`),
  INDEX `fk_Férias_Funcionário1_idx` (`Funcionario_cpf` ASC) VISIBLE,
  CONSTRAINT `fk_Férias_Funcionário1`
    FOREIGN KEY (`Funcionario_cpf`)
    REFERENCES `mydb`.`Funcionario` (`cpf`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `livraria`.`Vendas`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `livraria`.`Vendas` (
  `idVendas` INT NOT NULL,
  `valor` DECIMAL(6,2) NOT NULL,
  `receita` VARCHAR(45) NOT NULL,
  `data` DATE NOT NULL,
  `desconto` DECIMAL(6,2) NOT NULL,
  `Funcionario_cpf` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`idVendas`),
  INDEX `fk_Vendas_Funcionário1_idx` (`Funcionario_cpf` ASC) VISIBLE,
  CONSTRAINT `fk_Vendas_Funcionário1`
    FOREIGN KEY (`Funcionario_cpf`)
    REFERENCES `mydb`.`Funcionario` (`cpf`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `livraria`.`Cliente`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `livraria`.`Cliente` (
  `cpf` VARCHAR(45) NOT NULL,
  `nome` VARCHAR(45) NOT NULL,
  `telefone` VARCHAR(45) NOT NULL,
  `dataNasc` VARCHAR(45) NOT NULL,
  `sexo` VARCHAR(45) NOT NULL,
  `email` VARCHAR(45) NOT NULL,
  `Vendas_idVendas` INT NOT NULL,
  PRIMARY KEY (`cpf`),
  INDEX `fk_Cliente_Vendas1_idx` (`Vendas_idVendas` ASC) VISIBLE,
  CONSTRAINT `fk_Cliente_Vendas1`
    FOREIGN KEY (`Vendas_idVendas`)
    REFERENCES `mydb`.`Vendas` (`idVendas`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `livraria`.`Livros`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `livraria`.`Livros` (
  `isbn` INT NOT NULL,
  `autor` VARCHAR(45) NOT NULL,
  `descricao` VARCHAR(45) NOT NULL,
  `genero` VARCHAR(45) NOT NULL,
  `numPags` INT NOT NULL,
  `titulo` VARCHAR(45) NOT NULL,
  `dataPub` DATE NOT NULL,
  `editora` VARCHAR(45) NOT NULL,
  `Vendas_idVendas` INT NOT NULL,
  PRIMARY KEY (`isbn`),
  INDEX `fk_Livros_Vendas1_idx` (`Vendas_idVendas` ASC) VISIBLE,
  CONSTRAINT `fk_Livros_Vendas1`
    FOREIGN KEY (`Vendas_idVendas`)
    REFERENCES `mydb`.`Vendas` (`idVendas`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `livraria`.`EnderecoCli`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `livraria`.`EnderecoCli` (
  `bairro` INT NOT NULL,
  `uf` VARCHAR(45) NOT NULL,
  `comp` VARCHAR(45) NULL,
  `cidade` VARCHAR(45) NOT NULL,
  `numero` VARCHAR(45) NOT NULL,
  `cep` VARCHAR(45) NOT NULL,
  `rua` VARCHAR(45) NOT NULL,
  `Cliente_cpf` VARCHAR(45) NOT NULL,
  INDEX `fk_Endereço Cliente_Cliente1_idx` (`Cliente_cpf` ASC) VISIBLE,
  CONSTRAINT `fk_Endereço Cliente_Cliente1`
    FOREIGN KEY (`Cliente_cpf`)
    REFERENCES `mydb`.`Cliente` (`cpf`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `livraria`.`Autores`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `livraria`.`Autores` (
  `idAutores` INT NOT NULL,
  `nome` VARCHAR(45) NOT NULL,
  `dataNasc` DATE NOT NULL,
  `obrasEscritas` INT NOT NULL,
  `nacionalidade` VARCHAR(45) NOT NULL,
  `biografia` VARCHAR(45) NOT NULL,
  `Livros_isbn` INT NOT NULL,
  PRIMARY KEY (`idAutores`),
  INDEX `fk_Autores_Livros1_idx` (`Livros_isbn` ASC) VISIBLE,
  CONSTRAINT `fk_Autores_Livros1`
    FOREIGN KEY (`Livros_isbn`)
    REFERENCES `mydb`.`Livros` (`isbn`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `livraria`.`CDU`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `livraria`.`CDU` (
  `codigo` INT NOT NULL,
  `descricao` VARCHAR(45) NOT NULL,
  `area` VARCHAR(45) NOT NULL,
  `Livros_isbn` VARCHAR(20) NOT NULL,
  PRIMARY KEY (`codigo`),
  INDEX `fk_CDU_Livros1_idx` (`Livros_isbn` ASC) VISIBLE,
  CONSTRAINT `fk_CDU_Livros1`
    FOREIGN KEY (`Livros_isbn`)
    REFERENCES `mydb`.`Livros` (`isbn`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `livraria`.`Palavras`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `livraria`.`Palavras` (
  `codigo` INT NOT NULL,
  `descricao` VARCHAR(45) NOT NULL,
  `Livros_isbn` INT NOT NULL,
  PRIMARY KEY (`codigo`),
  INDEX `fk_Palavras Chave_Livros1_idx` (`Livros_isbn` ASC) VISIBLE,
  CONSTRAINT `fk_Palavras Chave_Livros1`
    FOREIGN KEY (`Livros_isbn`)
    REFERENCES `mydb`.`Livros` (`isbn`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `livraria`.`Exemplares`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `livraria`.`Exemplares` (
  `numSerie` INT NOT NULL,
  `localEstoque` VARCHAR(45) NOT NULL,
  `status` VARCHAR(45) NOT NULL,
  `Livros_isbn` INT NOT NULL,
  PRIMARY KEY (`numSerie`),
  INDEX `fk_Exemplares_Livros1_idx` (`Livros_isbn` ASC) VISIBLE,
  CONSTRAINT `fk_Exemplares_Livros1`
    FOREIGN KEY (`Livros_isbn`)
    REFERENCES `mydb`.`Livros` (`isbn`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `livraria`.`Departamentos`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `livraria`.`Departamentos` (
  `idDepartamentos` INT NOT NULL,
  `descricaoAtv` VARCHAR(45) NOT NULL,
  `reponsavel` VARCHAR(45) NOT NULL,
  `nome` VARCHAR(45) NOT NULL,
  `Funcionario_cpf` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`idDepartamentos`),
  INDEX `fk_Departamentos_Funcionário1_idx` (`Funcionario_cpf` ASC) VISIBLE,
  CONSTRAINT `fk_Departamentos_Funcionário1`
    FOREIGN KEY (`Funcionario_cpf`)
    REFERENCES `mydb`.`Funcionario` (`cpf`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- ------------------------------------------------------------------------------------------------------------------------------------------
-- ------------------------------------------------------------------------------------------------------------------------------------------

-- INSERT FUNCIONÁRIOS 35 --

INSERT INTO Funcionario (nome, dataNasc, estadoCivil, telefone, email, sexo, cpf) VALUES
('Ana Clara Silva', '1990-03-15', 'Solteira', '00001198765', 'anaclara@gmail.com', 'F', '00045678900'),
('Lucas Oliveira Santos', '1985-08-22', 'Casado', '00002199876', 'lucas.santos@hotmail.com', 'M', '00056789011'),
('Maria Fernanda Costa', '1995-01-30', 'Divorciada', '00003191234', 'maria.fer@gmail.com', 'F', '00067890122'),
('João Pedro Almeida', '1988-06-05', 'Solteiro', '00004198765', 'joaopedro@gmail.com', 'M', '00078901233'),
('Juliana Mendes', '1992-11-12', 'Casada', '00005199876', 'juliana.mendes@yahoo.com', 'F', '00089012344'),
('Rafael Santos Lima', '1983-04-18', 'Casado', '00006191234', 'rafael.lima@gmail.com', 'M', '00090123455'),
('Beatriz Rocha', '1991-09-25', 'Solteira', '00007199876', 'beatriz.rocha@hotmail.com', 'F', '00001234566'),
('Felipe Andrade', '1987-02-07', 'Divorciado', '00008198765', 'felipe.andrade@yahoo.com', 'M', '00012345677'),
('Larissa Nascimento', '1994-10-30', 'Solteira', '00009191234', 'larissa.nascimento@gmail.com', 'F', '00023456788'),
('Gustavo Pereira', '1980-12-14', 'Casado', '00005199876', 'gustavo.pereira@hotmail.com', 'M', '00034567899'),
('Thiago Martins', '1993-05-18', 'Solteiro', '00010293847', 'thiago.martins@gmail.com', 'M', '00045678901'),
('Patrícia Lima', '1989-07-22', 'Casada', '00020394856', 'patricia.lima@yahoo.com', 'F', '00056789012'),
('Roberto Ferreira', '1982-01-14', 'Divorciado', '00030485967', 'roberto.ferreira@hotmail.com', 'M', '00067890123'),
('Camila Alves', '1995-12-30', 'Solteira', '00040596078', 'camila.alves@gmail.com', 'F', '00078901234'),
('André Souza', '1984-03-05', 'Casado', '00050607189', 'andre.souza@yahoo.com', 'M', '00089012345'),
('Fernanda Rocha', '1990-10-16', 'Solteira', '00060718290', 'fernanda.rocha@hotmail.com', 'F', '00090123456'),
('Vinícius Dias', '1987-08-09', 'Casado', '00070829301', 'vinicius.dias@gmail.com', 'M', '00001234567'),
('Juliana Costa', '1991-04-11', 'Divorciada', '00080930412', 'juliana.costa@yahoo.com', 'F', '00012345678'),
('Eduardo Almeida', '1986-09-28', 'Solteiro', '00091041523', 'eduardo.almeida@hotmail.com', 'M', '00023456789'),
('Mariana Martins', '1992-11-05', 'Casada', '00001152634', 'mariana.martins@gmail.com', 'F', '00034567890'),
('Ana Clara Silva', '1990-03-15', 'Solteira', '00001198765', 'anaclara@gmail.com', 'F', '11223344556'),
('Lucas Oliveira Santos', '1985-08-22', 'Casado', '00002199876', 'lucas.santos@hotmail.com', 'M', '12345678901'),
('Maria Fernanda Costa', '1995-01-30', 'Divorciada', '00003191234', 'maria.fer@gmail.com', 'F', '12345678905'),
('João Pedro Almeida', '1988-06-05', 'Solteiro', '00004198765', 'joaopedro@gmail.com', 'M', '22334455667'),
('Juliana Mendes', '1992-11-12', 'Casada', '00005199876', 'juliana.mendes@yahoo.com', 'F', '23456789012'),
('Rafael Santos Lima', '1983-04-18', 'Casado', '00006191234', 'rafael.lima@gmail.com', 'M', '33445566778'),
('Beatriz Rocha', '1991-09-25', 'Solteira', '00007199876', 'beatriz.rocha@hotmail.com', 'F', '34567890123'),
('Felipe Andrade', '1987-02-07', 'Divorciado', '00008198765', 'felipe.andrade@yahoo.com', 'M', '44556677889'),
('Larissa Nascimento', '1994-10-30', 'Solteira', '00009191234', 'larissa.nascimento@gmail.com', 'F', '45678901234'),
('Gustavo Pereira', '1980-12-14', 'Casado', '00005199876', 'gustavo.pereira@hotmail.com', 'M', '55667788990'),
('Thiago Martins', '1993-05-18', 'Solteiro', '00010293847', 'thiago.martins@gmail.com', 'M', '56789012345'),
('Patrícia Lima', '1989-07-22', 'Casada', '00020394856', 'patricia.lima@yahoo.com', 'F', '67890123456'),
('Roberto Ferreira', '1982-01-14', 'Divorciado', '00030485967', 'roberto.ferreira@hotmail.com', 'M', '78901234567'),
('Camila Alves', '1995-12-30', 'Solteira', '00040596078', 'camila.alves@gmail.com', 'F', '89012345678'),
('André Souza', '1984-03-05', 'Casado', '00050607189', 'andre.souza@yahoo.com', 'M', '90123456789');

-- ----------------------------------------------- 
SELECT * FROM Funcionario
	ORDER BY nome;
    
select count(*) from funcionario;
-- -----------------------------------------------

-- INSERTS DO GRUPO CDU 10 --

INSERT INTO CDU (codigo, descricao, area, Livros_isbn) VALUES
(0, 'Introdução à Programação', 'Ciências Exatas', 9781234567890),
(1, 'Ciências da Computação', 'Ciências Exatas', 9780987654321),
(2, 'Matemática Discreta', 'Ciências Exatas', 9781234509876),
(3, 'Teoria da Computação', 'Ciências Exatas', 9781234598765),
(5, 'Algoritmos', 'Ciências Exatas', 9781234512345),
(6, 'Redes de Computadores', 'Ciências Exatas', 9781234523456),
(7, 'Sistemas Operacionais', 'Ciências Exatas', 9781234534567),
(8, 'Inteligência Artificial', 'Ciências Exatas', 9781234545678),
(9, 'Programação Orientada a Objetos', 'Ciências Exatas', 9781234556789),
(10, 'Desenvolvimento Web', 'Ciências Exatas', 9781234578901);

-- -----------------------------------------------
select * from cdu
	order by descricao;
-- -----------------------------------------------

-- INSERTS FERIAS 10 --

INSERT INTO ferias (idFerias, dataFim, dataIni, qtdDias, anoRef, Funcionario_cpf) VALUES
(1, '2024-01-10', '2024-01-01', 10, '2024-01-01', '123.456.789-00'),
(2, '2024-02-15', '2024-02-05', 10, '2024-02-01', '234.567.890-11'),
(3, '2024-03-20', '2024-03-10', 10, '2024-03-01', '345.678.901-22'),
(4, '2024-04-25', '2024-04-15', 10, '2024-04-01', '456.789.012-33'),
(5, '2024-05-30', '2024-05-20', 10, '2024-05-01', '567.890.123-44'),
(6, '2024-06-15', '2024-06-05', 10, '2024-06-01', '678.901.234-55'),
(7, '2024-07-10', '2024-07-01', 10, '2024-07-01', '789.012.345-66'),
(8, '2024-08-20', '2024-08-10', 10, '2024-08-01', '890.123.456-77'),
(9, '2024-09-30', '2024-09-20', 10, '2024-09-01', '901.234.567-88'),
(10, '2024-10-15', '2024-10-05', 10, '2024-10-01', '012.345.678-99'),
(11, '2024-11-25', '2024-11-15', 10, '2024-11-01', '123.456.789-01'),
(12, '2024-12-20', '2024-12-10', 10, '2024-12-01', '234.567.890-12'),
(13, '2024-01-05', '2023-12-27', 9, '2024-01-01', '345.678.901-23'),
(14, '2024-03-30', '2024-03-20', 10, '2024-03-01', '456.789.012-34'),
(15, '2024-06-30', '2024-06-20', 10, '2024-06-01', '567.890.123-45');

-- -----------------------------------------------
select * from ferias
	order by dataIni;
-- -----------------------------------------------

-- INSERT AUTORES 10 --

INSERT INTO autores (idAutores, nome, dataNasc, obrasEscritas, nacionalidade, biografia, Livros_isbn) VALUES
(1, 'Gabriel Garcia Márquez', '1927-03-06', 25, 'Colombiana', 'Autor de "Cem Anos de Solidão", conhecido pelo realismo mágico.', 9788503002000),
(2, 'J.K. Rowling', '1965-07-31', 15, 'Britânica', 'Criadora da série "Harry Potter", que encantou gerações.', 9788532520327),
(3, 'Machado de Assis', '1839-06-21', 20, 'Brasileira', 'Considerado um dos maiores escritores da literatura brasileira.', 9788526001534),
(4, 'Jane Austen', '1775-12-16', 6, 'Britânica', 'Famosa por seus romances que exploram a vida das mulheres no século XIX.', 9788535930920),
(5, 'Ernest Hemingway', '1899-07-21', 27, 'Americana', 'Reconhecido por seu estilo de escrita conciso e impactante.', 9788535930982),
(6, 'Clarice Lispector', '1920-12-10', 18, 'Brasileira', 'Autora introspectiva, conhecida por obras como "A Hora da Estrela".', 9788535926664),
(7, 'George Orwell', '1903-06-25', 10, 'Britânica', 'Famoso por suas obras "1984" e "A Revolução dos Bichos".', 9788535924707),
(8, 'F. Scott Fitzgerald', '1896-09-24', 5, 'Americana', 'Reconhecido por seu romance "O Grande Gatsby".', 9788535926664),
(9, 'Virginia Woolf', '1882-01-25', 10, 'Britânica', 'Uma das principais figuras do modernismo literário.', 9788535924806),
(10, 'Stephen King', '1947-09-21', 63, 'Americana', 'Famoso por suas obras de terror e ficção, incluindo "It" e "The Shining".', 9788535925759);

-- -----------------------------------------------
ALTER TABLE autores
CHANGE biografia biografia VARCHAR(200);

ALTER TABLE autores
CHANGE Livros_isbn Livros_isbn VARCHAR(45);

select * from autores
	order by nome;
-- -----------------------------------------------

-- INSERT CLIENTES 20 --

INSERT INTO cliente (cpf, nome, telefone, dataNasc, sexo, email, Vendas_idVendas) VALUES
('123.456.789-00', 'Ana Clara Silva', '00001198765', '1990-03-15', 'F', 'anaclara@gmail.com', 1),
('234.567.890-11', 'Lucas Oliveira Santos', '00002199876', '1985-08-22', 'M', 'lucas.santos@hotmail.com', 2),
('345.678.901-22', 'Maria Fernanda Costa', '00003191234', '1995-01-30', 'F', 'maria.fer@gmail.com', 3),
('456.789.012-33', 'João Pedro Almeida', '00004198765', '1988-06-05', 'M', 'joaopedro@gmail.com', 4),
('567.890.123-44', 'Juliana Mendes', '00005199876', '1992-11-12', 'F', 'juliana.mendes@yahoo.com', 5),
('678.901.234-55', 'Rafael Santos Lima', '00006191234', '1983-04-18', 'M', 'rafael.lima@gmail.com', 6),
('789.012.345-66', 'Beatriz Rocha', '00007199876', '1991-09-25', 'F', 'beatriz.rocha@hotmail.com', 7),
('890.123.456-77', 'Felipe Andrade', '00008198765', '1987-02-07', 'M', 'felipe.andrade@yahoo.com', 8),
('901.234.567-88', 'Larissa Nascimento', '00009191234', '1994-10-30', 'F', 'larissa.nascimento@gmail.com', 9),
('012.345.678-99', 'Gustavo Pereira', '00005199876', '1980-12-14', 'M', 'gustavo.pereira@hotmail.com', 10),
('123.456.789-01', 'Tatiane Souza', '00011123456', '1989-07-22', 'F', 'tatiane.souza@gmail.com', 11),
('234.567.890-12', 'André Lima', '00012134567', '1982-03-05', 'M', 'andre.lima@yahoo.com', 12),
('345.678.901-23', 'Juliana Pereira', '00013145678', '1993-05-10', 'F', 'juliana.pereira@hotmail.com', 13),
('456.789.012-34', 'Carlos Alberto', '00014156789', '1987-08-17', 'M', 'carlos.alberto@gmail.com', 14),
('567.890.123-45', 'Sofia Martins', '00015167890', '1991-12-02', 'F', 'sofia.martins@yahoo.com', 15),
('678.901.234-56', 'Fernando Rocha', '00016178901', '1985-09-11', 'M', 'fernando.rocha@gmail.com', 16),
('789.012.345-67', 'Laura Costa', '00017189012', '1994-01-20', 'F', 'laura.costa@hotmail.com', 17),
('890.123.456-78', 'Tiago Ferreira', '00018190123', '1988-04-15', 'M', 'tiago.ferreira@yahoo.com', 18),
('901.234.567-89', 'Nathalia Ribeiro', '00019101234', '1992-11-30', 'F', 'nathalia.ribeiro@gmail.com', 19),
('012.345.678-00', 'Ricardo Gomes', '00020112345', '1981-10-25', 'M', 'ricardo.gomes@hotmail.com', 20);

-- -----------------------------------------------
select * from cliente
	order by nome;
-- -----------------------------------------------

-- INSERT DE ENDEREÇOS FUNCIONÁRIOS 20 --

INSERT INTO endereco (bairro, uf, comp, cidade, numero, cep, rua, Funcionario_cpf) VALUES
('Centro', 'SP', 'Apto 101', 'São Paulo', '100', '01001-000', 'Rua da Paz', '00045678900'),
('Jardins', 'SP', 'Casa', 'São Paulo', '200', '01412-000', 'Avenida Brasil', '00056789011'),
('Botafogo', 'RJ', 'Andar 3', 'Rio de Janeiro', '150', '22250-000', 'Rua da Liberdade', '00067890122'),
('Pinheiros', 'SP', 'Sem complemento', 'São Paulo', '350', '05422-000', 'Rua dos Três Irmãos', '00078901233'),
('Lapa', 'RJ', 'Sala 2', 'Rio de Janeiro', '75', '20021-000', 'Rua do Lavradio', '00089012344'),
('Ipanema', 'RJ', 'Cobertura', 'Rio de Janeiro', '40', '22410-000', 'Avenida Vieira Souto', '00090123455'),
('Vila Mariana', 'SP', 'Apto 12', 'São Paulo', '500', '04101-000', 'Rua Domingos de Morais', '00001234566'),
('São Conrado', 'RJ', 'Chácara 3', 'Rio de Janeiro', '1000', '22610-000', 'Avenida Epitácio Pessoa', '00012345677'),
('Santana', 'SP', 'Galpão', 'São Paulo', '300', '02012-000', 'Rua Voluntários da Pátria', '00023456788'),
('Moema', 'SP', 'Apto 305', 'São Paulo', '250', '04514-000', 'Avenida Ibirapuera', '00034567899'),
('Vila Madalena', 'SP', 'Casa 5', 'São Paulo', '150', '05468-000', 'Rua dos Pinheiros', '00045678901'),
('Leblon', 'RJ', 'Apto 202', 'Rio de Janeiro', '300', '22430-000', 'Avenida General San Martin', '00056789012'),
('Copacabana', 'RJ', 'Andar 4', 'Rio de Janeiro', '50', '22040-000', 'Rua Miguel Lemos', '00067890123'),
('Jardim Paulista', 'SP', 'Sem complemento', 'São Paulo', '400', '01410-000', 'Rua Pamplona', '00078901234'),
('Brooklin', 'SP', 'Apto 15', 'São Paulo', '250', '04578-000', 'Avenida Santo Amaro', '00089012345'),
('Bela Vista', 'SP', 'Sala 8', 'São Paulo', '350', '01310-000', 'Rua da Consolação', '00090123456'),
('Laranjeiras', 'RJ', 'Apto 101', 'Rio de Janeiro', '250', '22240-000', 'Rua General Glicério', '00001234567'),
('Flamengo', 'RJ', 'Sem complemento', 'Rio de Janeiro', '600', '22210-000', 'Praia do Flamengo', '00012345678'),
('Pinheiros', 'SP', 'Casa 2', 'São Paulo', '400', '05422-000', 'Rua dos Três Irmãos', '00023456789'),
('Tijuca', 'RJ', 'Apto 12', 'Rio de Janeiro', '80', '20520-000', 'Rua São Francisco Xavier', '00034567890');

-- ----------------------------------------
SELECT * FROM endereco
	order by uf;
-- ----------------------------------------

-- REMOVE OS DADOS DE ENDEREÇO (NÃO USAR)
truncate table endereco;
-- ----------------------

-- INSERTS DE DEPENDENTES 10 --

INSERT INTO dependentes (cpf, parentesco, dataNasc, nome, funcionario_cpf) VALUES
(12345678901, 'Filho', '2015-01-15', 'Lucas Silva', 12345678901),
(23456789012, 'Filho', '2013-05-20', 'Ana Souza', 12345678901),
(34567890123, 'Filha', '2018-09-10', 'Maria Oliveira', 23456789012),
(45678901234, 'Esposa', '1990-11-30', 'Juliana Pereira', 34567890123),
(56789012345, 'Marido', '1988-02-14', 'Carlos Santos', 45678901234),
(67890123456, 'Filho', '2020-06-22', 'Felipe Lima', 56789012345),
(78901234567, 'Filha', '2019-03-18', 'Beatriz Costa', 67890123456),
(89012345678, 'Mãe', '1975-07-05', 'Eliana Almeida', 78901234567),
(90123456789, 'Pai', '1972-12-12', 'Ricardo Gomes', 89012345678),
(11223344556, 'Filho', '2016-08-25', 'Rafael Dias', 90123456789),
(22334455667, 'Filha', '2017-04-30', 'Sofia Martins', 11223344556),
(33445566778, 'Irmão', '1995-02-15', 'Bruno Rodrigues', 22334455667),
(44556677889, 'Irmã', '1998-09-27', 'Carla Mendes', 33445566778),
(55667788990, 'Avô', '1955-03-22', 'José Santos', 44556677889),
(66778899001, 'Avó', '1960-05-14', 'Maria da Luz', 55667788990);

-- ---------------------------------------- 
ALTER TABLE dependentes
CHANGE cpf cpf VARCHAR(20);

select * from dependentes
	order by nome;
-- ---------------------------------------- 

-- INSERTS DE ENDEREÇOS CLIENTES 20 --

INSERT INTO EnderecoCli (bairro, uf, comp, cidade, numero, cep, rua, Cliente_cpf) VALUES
('Vila Nova Conceição', 'SP', 'Apto 303', 'São Paulo', '300', '04513-000', 'Rua João Cachoeira', '00045678912'),
('Ipanema', 'RJ', 'Cobertura', 'Rio de Janeiro', '400', '22420-000', 'Avenida Vieira Souto', '00056789023'),
('Bairro Alto', 'RJ', 'Sem complemento', 'Rio de Janeiro', '100', '22230-000', 'Rua João Paulo', '00067890134'),
('Vila Olímpia', 'SP', 'Casa 10', 'São Paulo', '250', '04551-000', 'Rua Gomes de Carvalho', '00078901245'),
('Morumbi', 'SP', 'Apto 105', 'São Paulo', '600', '05622-000', 'Avenida Professor Francisco Morato', '00089012356'),
('Alto da Boa Vista', 'SP', 'Sem complemento', 'São Paulo', '550', '04610-000', 'Rua Mário Lopes', '00090123467'),
('Centro Histórico', 'SP', 'Sala 201', 'São Paulo', '200', '01025-000', 'Rua da São Bento', '00001234578'),
('Urca', 'RJ', 'Apto 202', 'Rio de Janeiro', '80', '22290-000', 'Rua Pedro Alves', '00012345689'),
('Praia da Barra', 'RJ', 'Chácara 1', 'Rio de Janeiro', '2000', '22620-000', 'Avenida Sernambetiba', '00023456790'),
('Chácara Santo Antonio', 'SP', 'Casa 8', 'São Paulo', '400', '04713-000', 'Rua Maracá', '00034567801'),
('Vila Nova Conceição', 'SP', 'Apto 303', 'São Paulo', '300', '04513-000', 'Rua João Cachoeira', '00045678912'),
('Ipanema', 'RJ', 'Cobertura', 'Rio de Janeiro', '400', '22420-000', 'Avenida Vieira Souto', '00056789023'),
('Jardim Paulista', 'SP', 'Sem complemento', 'São Paulo', '250', '01410-000', 'Rua Pamplona', '00067890134'),
('Vila Mariana', 'SP', 'Casa 15', 'São Paulo', '500', '04101-000', 'Rua Domingos de Morais', '00078901245'),
('Botafogo', 'RJ', 'Apto 201', 'Rio de Janeiro', '150', '22250-000', 'Rua da Liberdade', '00089012356'),
('Morumbi', 'SP', 'Casa 12', 'São Paulo', '600', '05622-000', 'Avenida Professor Francisco Morato', '00090123467'),
('Flamengo', 'RJ', 'Sem complemento', 'Rio de Janeiro', '300', '22210-000', 'Praia do Flamengo', '00001234578'),
('Santa Teresa', 'RJ', 'Apto 5', 'Rio de Janeiro', '80', '22240-000', 'Rua Almirante Alexandrino', '00012345689'),
('Pinheiros', 'SP', 'Casa 3', 'São Paulo', '400', '05422-000', 'Rua dos Três Irmãos', '00023456790'),
('Bela Vista', 'SP', 'Sala 8', 'São Paulo', '350', '01310-000', 'Rua da Consolação', '00034567801');

-- ----------------------------------------
ALTER TABLE enderecoCli
CHANGE bairro bairro VARCHAR(45);

SELECT * FROM enderecoCli
	order by uf;
-- ----------------------------------------

-- INSERTS LIVROS 10 --

INSERT INTO livros (isbn, autor, descricao, genero, numPags, titulo, dataPub, editora, Vendas_idVendas) VALUES
(9788503002000, 'Gabriel García Márquez', 'Uma história de amor e solidão', 'Ficção', 320, 'Cem Anos de Solidão', '1967-05-30', 'Editora X', 1),
(9788532520327, 'J.K. Rowling', 'A jornada de um jovem mago', 'Fantasia', 400, 'Harry Potter e a Pedra Filosofal', '1997-06-26', 'Editora Y', 2),
(9788526001534, 'George Orwell', 'Uma crítica à sociedade totalitária', 'Distopia', 328, '1984', '1949-06-08', 'Editora Z', 3),
(9788535930920, 'Harper Lee', 'A história de um advogado e seus filhos', 'Drama', 281, 'O Sol é Para Todos', '1960-07-11', 'Editora W', 4),
(9788535930982, 'F. Scott Fitzgerald', 'Uma crítica à vida americana', 'Ficção', 180, 'O Grande Gatsby', '1925-04-10', 'Editora V', 5),
(9788535926664, 'J.R.R. Tolkien', 'A busca por um anel mágico', 'Fantasia', 550, 'O Senhor dos Anéis: A Sociedade do Anel', '1954-07-29', 'Editora U', 6),
(9788535924707, 'Margaret Atwood', 'Uma história de resistência feminina', 'Ficção Científica', 400, 'O Conto da Aia', '1985-04-17', 'Editora T', 7),
(9788535924806, 'Stephen King', 'Um suspense psicológico', 'Terror', 480, 'O Iluminado', '1977-01-28', 'Editora S', 8),
(9788535925759, 'Isaac Asimov', 'Futuro da robótica e da inteligência', 'Ficção Científica', 256, 'Eu, Robô', '1950-12-02', 'Editora R', 9),
(9788535925742, 'Dan Brown', 'Um thriller de mistério', 'Ficção', 480, 'O Código Da Vinci', '2003-03-18', 'Editora Q', 10);

-- ----------------------------------------
ALTER TABLE livros
CHANGE isbn isbn VARCHAR(45);

select * from livros
	order by autor;
-- ----------------------------------------

-- INSERT DE PALAVRAS CHAVES DOS LIVROS 10 --

INSERT INTO Palavras (codigo, descricao, Livros_isbn) VALUES
(100001, 'Amor', 9788503002000),
(100002, 'Liberdade', 9788532520327),
(100003, 'Aventura', 9788526001534),
(100004, 'Conhecimento', 9788535930920),
(100005, 'Esperança', 9788535930982),
(100006, 'Sabedoria', 9788535926664),
(100007, 'Coragem', 9788535924707),
(100008, 'Felicidade', 9788535924806),
(100009, 'Sonhos', 9788535925759),
(100010, 'Mudança', 9788535925742);

-- ----------------------------------------
ALTER TABLE palavras
CHANGE Livros_isbn Livros_isbn VARCHAR(45);

select * from palavras
	order by descricao;
-- ----------------------------------------

-- INSERT DE VENDAS DOS FUNCIONARIOS

INSERT INTO Vendas (idVendas, valor, receita, data, desconto, Funcionario_cpf) VALUES
(1, 150.00, 'Venda de livro', '2024-01-15', 10.00, '123.456.789-00'),
(2, 200.00, 'Venda de livro', '2024-01-16', 15.00, '234.567.890-11'),
(3, 300.00, 'Venda de livro', '2024-01-17', 20.00, '345.678.901-22'),
(4, 250.00, 'Venda de livro', '2024-01-18', 5.00, '456.789.012-33'),
(5, 175.00, 'Venda de livro', '2024-01-19', 12.50, '567.890.123-44'),
(6, 120.00, 'Venda de livro', '2024-01-20', 8.00, '678.901.234-55'),
(7, 400.00, 'Venda de livro', '2024-01-21', 30.00, '789.012.345-66'),
(8, 350.00, 'Venda de livro', '2024-01-22', 25.00, '890.123.456-77'),
(9, 220.00, 'Venda de livro', '2024-01-23', 18.00, '901.234.567-88'),
(10, 180.00, 'Venda de livro', '2024-01-24', 10.00, '012.345.678-99');

-- ----------------------------------------
select * from vendas
	order by valor;
-- ----------------------------------------

-- INSERT DE EXEMPLARES DOS LIVROS 10 --

INSERT INTO exemplares (numSerie, localEstoque, status, Livros_isbn) VALUES
(100001, 'Estante A', 'Disponível', 9788503002000),
(100002, 'Estante B', 'Emprestado', 9788532520327),
(100003, 'Estante C', 'Reservado', 9788526001534),
(100004, 'Estante D', 'Disponível', 9788535930920),
(100005, 'Estante E', 'Disponível', 9788535930982),
(100006, 'Estante A', 'Emprestado', 9788535926664),
(100007, 'Estante B', 'Disponível', 9788535924707),
(100008, 'Estante C', 'Reservado', 9788535924806),
(100009, 'Estante D', 'Disponível', 9788535925759),
(100010, 'Estante E', 'Emprestado', 9788535925742);

-- ----------------------------------------
ALTER TABLE exemplares
CHANGE Livros_isbn Livros_isbn VARCHAR(45);

select * from exemplares
	order by status;
-- ----------------------------------------

-- INSERT DE DEPARTAMENTOS

INSERT INTO departamentos (idDepartamentos, descricaoAtv, reponsavel, nome, Funcionario_cpf) VALUES
(16785290, 'Desenvolvimento de Software', 'Carlos Silva', 'Desenvolvimento', 12345678900),
(23456702, 'Recursos Humanos', 'Maria Oliveira', 'RH', 23456789011),
(32458902, 'Financeiro', 'Ana Souza', 'Financeiro', 34567890122),
(43456780, 'Marketing', 'Lucas Mendes', 'Marketing', 45678901233),
(56578120, 'Vendas', 'Juliana Costa', 'Vendas', 56789012344),
(63456720, 'Suporte Técnico', 'Fernando Rocha', 'Suporte', 67890123455),
(75123470, 'Logística', 'Tatiane Almeida', 'Logística', 78901234566),
(82305140, 'Pesquisa e Desenvolvimento', 'Roberto Lima', 'P&D', 89012345677),
(93258490, 'TI', 'Cláudia Nascimento', 'Tecnologia da Informação', 90123456788),
(10720310, 'Qualidade', 'Renato Gomes', 'Controle de Qualidade', 01234567899);

-- ----------------------------------------
select * from departamentos
	order by nome;
-- ----------------------------------------

-- ----------------------------------------------- RELATORIOS DE SELECT

-- 1 QUANTAS COMPRAS CADA CLIENTE REALIZOU? OK

SELECT 
    c.nome as  "Nome", 
    COUNT(v.idVendas) AS "Quantidade de Compras"
FROM 
    livraria.Cliente c
JOIN 
    vendas v ON c.Vendas_idVendas = v.idVendas
GROUP BY 
    c.nome;

-- 2 QUAL É O LUCRO LÍQUIDO POR CLIENTE? OK

SELECT 
    c.nome "Nome", 
     concat('R$ ', format(v.valor - v.desconto, 2, 'de_DE')) "Lucro Líquido"
FROM 
    livraria.Cliente c
JOIN 
    vendas v ON c.Vendas_idVendas = v.idVendas;

  -- 3 QUAL O NOME DE CADA DEPENDENTE E DE SEU RESPECTIVO RESPONSÁVEL? OK
  
  select 
  dep.nome as "Nome do Dependente",
  fun.nome as "Nome do funcionário"
  from dependentes as dep
  left join funcionario as fun on dep.funcionario_cpf = fun.cpf;
  
  -- 4 QUAL O NOME DOS DEPENDETES DOS FUNCIONÁRIOS CUJO NOMES E SOBRENOMES TERMINAM COM A LETRA "A"? OK
  
   select 
  dep.nome as "Nome do Dependente",
  fun.nome as "Nome do Funcionário"
  from dependentes as dep
  left join funcionario as fun on dep.funcionario_cpf = fun.cpf
  where dep.nome like "%Ra%";
  
  -- 5 QUAIS SÃO OS CINCO DEPENDENTES MAIS VELHOS? OK
  
  select 
  date_format(dep.dataNasc, '%d/%m/%Y') as "Data de Nascimento",
  timestampdiff(year, dep.dataNasc, now(6)) "Idade",
  dep.nome as "Dependente",
  fun.nome as "Funcionário",
  fun.cpf as "CPF"
  from dependentes as dep
  left join funcionario as fun
  on fun.cpf = dep.funcionario_cpf
  order by dep.dataNasc
  limit 5;

 
 -- 6 QUAIS SÃO OS CINCO LIVROS MAIS CAROS? OK
 
select 
 liv.titulo "Título",
 concat('R$ ', format(ven.valor, 2, 'de_DE')) "Valor"
 from livros as liv 
 join vendas as ven
 on ven.idVendas = liv.vendas_idVendas
 order by valor desc
 limit 5;
 
 -- 7 QUAIS LIVROS FORAM ESCRITOS NA DÉCADA DE 50? OK
 
 select 
 aut.nome "Nome",
 liv.titulo "Título",
 date_format(liv.dataPub, '%d/%m/%Y') as "Data de Publicação"
 from autores as aut
 join livros as liv
 on liv.isbn = aut.livros_isbn
 where dataPub between '1950-01-01' and '1960-01-01'
 order by liv.dataPub;
 
 -- 8 QUAIS LIVROS DA AUTORA CLARICE LISPECTOR TEMOS NO NOSSOS ESTOQUES? OK
 
  select 
 aut.nome "Nome",
 liv.titulo "Título",
 date_format(liv.dataPub, '%d/%m/%Y') "Data de Publicação"
 from autores as aut
 join livros as liv
 on liv.isbn = aut.livros_isbn
 where aut.nome = "Clarice Lispector";
 

 -- 9 QUAIS PALAVRAS-CHAVES DESCREVEM CADA LIVRO? OK
 
 select 
 pal.descricao "Descrição",
 liv.titulo "Título"
 from palavras as pal
 join livros as liv 
 on pal.livros_isbn = liv.isbn;
 
 -- 10 QUAL FOI O SALDO DE CADA DIA? OK
 
 select  date_format(data, '%d/%m/%Y') "Data",
 concat('R$ ', format(sum(valor), 2, 'de_DE')) "Saldo"
 from vendas
 group by data;
 
 
 -- 11 QUAL O LUCRO OBTIDO POR CADA TÍTULO? OK
 
 select 
 concat('R$ ', format(sum(ven.valor) * count(vendas_idvendas), 2, 'de_DE')) "Lucro",
 liv.titulo "Título"
 from vendas as ven
 join livros as liv
 on ven.idVendas = liv.vendas_idvendas
 group by liv.titulo;
 
 -- 12 QUAL O VALOR TOTAL GASTO PELOS CLIENTES CUJO NOME OU SOBRENOME TERMINA COM A LETRA "A"? OK
 
select 
cli.nome "Nome do Cliente",
concat('R$ ', format(sum(ven.valor), 2, 'de_DE')) "Valor Total"
from vendas as ven
join cliente as cli
where cli.nome like "%a"
group by cli.nome;

-- 13 QUAL SÃO OS TRÊS TÍTULOS MAIS LUCRATIVOS? OK

 select 
 concat('R$ ', format(sum(ven.valor) * count(vendas_idVendas), 2, 'de_DE')) "Lucro",
 liv.titulo "Título"
 from vendas as ven
 join livros as liv
 on ven.idVendas = liv.vendas_idvendas
 group by liv.titulo
 order by  sum(ven.valor) * count(vendas_idvendas) desc
 limit 3;

-- 14 QUAIS SÃO OS TRÊS DIAS QUE DERAM MAIS LUCRO? OK

 select date_format(data, '%d/%m/%Y') "Data",
 concat('R$ ', format(sum(valor), 2, 'de_DE')) "Lucro"
 from vendas
 group by data
 order by sum(valor) desc
 limit 3;
 
 -- 15 QUAIS LIVROS FORAM ESCRITOS POR AUTORES CUJO NOME COMEÇA COM A LETRA "S"? OK
 
 select 
 aut.nome "Nome",
 liv.titulo "Livro",
 date_format(liv.dataPub, '%d/%m/%Y') "Data de Publicação"
 from autores as aut
 join livros as liv
 on liv.isbn = aut.livros_isbn
 where aut.nome like "s%";

 --  16 QUAIS LIVROS FORAM ESCRITOS NA DÉCADA DE 50 PELO AUTOR STEPHEN KING? OK
 
 select 
 aut.nome "Autor",
 liv.titulo "Título",
 date_format(liv.dataPub, '%d/%m/%Y') "Data de Publicação"
 from autores as aut
 join livros as liv
 on liv.isbn = aut.livros_isbn
 where dataPub between '1950-01-01' and '1960-01-01'
 and aut.nome = "stephen king"
 order by liv.dataPub;
 
 -- 17 QUAL O LIVRO MAIS LUCRATIVO PUBLICADO NA DÉCADA DE 1950? OK
 
 select 
 concat('R$ ', format(sum(ven.valor) * count(vendas_idVendas), 2, 'de_DE')) "Lucro",
 liv.titulo "Livro"
 from vendas as ven
 join livros as liv
 on ven.idVendas = liv.vendas_idvendas
 where liv.dataPub between '1950-01-01' and '1960-01-01'
 group by liv.titulo
 order by  sum(ven.valor) * count(vendas_idvendas) desc
 limit 1;
 
 -- 18 QUAIS LIVROS DISPONÍVEIS CUJO A PALAVRAS-CHAVES TERMINAM COM "A"? OK
 
select 
 pal.descricao "Palavra Chave",
 liv.titulo "Título"
 from palavras as pal
 join livros as liv 
 on pal.livros_isbn = liv.isbn
 where pal.descricao like "%a";
 
 -- 19 QUAIS LIVROS CUSTAM ENTRE 100 E 250? OK
 
 select 
 liv.titulo "Título",
 concat('R$ ', format(ven.valor, 2, 'de_DE')) "Valor"
 from livros as liv 
 join vendas as ven
 on ven.idVendas = liv.vendas_idVendas
 where ven.valor between 100 and 250
 order by valor desc;
 
 -- 20 QUAIS É O LIVRO MAIS BARATO ESCRITO APÓS O ANO DE 1964? OK
 
 select 
 liv.titulo "Título",
 concat('R$ ', format(ven.valor, 2, 'de_DE')) "Valor"
 from livros as liv 
 join vendas as ven
 on ven.idVendas = liv.vendas_idVendas
 where dataPub > "1965-01-01"
 order by valor
 limit 1;
 
 -- --------------------------------------------------- FIM LINDO DE MORRER
  
